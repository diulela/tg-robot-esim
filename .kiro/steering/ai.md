---
inclusion: always
---

# AI 助手工作指南

## 语言和交流规范

- **始终使用中文回复**：所有响应、代码注释、文档和错误信息都应使用中文
- 技术术语可保留英文，但需要提供中文解释
- 代码变量名和函数名使用英文，但注释使用中文

## 代码开发规范

### Go 代码风格
- 遵循 Go 官方代码规范和 `gofmt` 格式化
- 函数和方法必须包含中文注释说明功能
- 错误处理必须完整，使用 Go 惯用的错误处理模式
- 接口优先设计，所有服务都应定义接口

### 项目特定约定
- 新增处理器必须实现 `CommandHandler` 接口并在 `registry.go` 中注册
- 服务层接口定义在 `services/interfaces.go` 中
- 使用依赖注入模式，避免硬编码依赖
- 配置通过环境变量和 JSON 配置文件管理

## 业务逻辑指导

### Telegram Bot 开发
- 所有用户交互使用 InlineKeyboard 或 ReplyKeyboard
- 通过 CallbackQuery 处理按钮点击事件
- 维护用户会话状态，支持多步骤对话流程
- 错误情况下向用户提供清晰的中文提示

### 区块链集成
- TRON 网络交易监控必须处理网络延迟和失败重试
- 支付确认前不能发放商品
- 实现交易状态的实时更新和通知

### 数据处理
- 使用 GORM 进行数据库操作
- 所有数据库操作必须包含错误处理
- 敏感数据（如私钥、API密钥）通过环境变量管理

## 开发流程

### 新功能开发
1. 先定义接口（在相应的 `interfaces.go` 文件中）
2. 实现具体功能
3. 编写中文注释和文档
4. 进行错误处理和边界情况测试

### 代码审查要点
- 检查是否遵循项目架构模式
- 确认错误处理的完整性
- 验证中文注释的准确性
- 测试用户交互流程的完整性

## 调试和问题解决

- 使用结构化日志记录，日志信息使用中文
- 区块链相关问题优先检查网络连接和API密钥
- Telegram Bot 问题检查 webhook 配置和令牌有效性
- 数据库问题检查连接字符串和权限设置